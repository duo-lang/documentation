<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Declarations - Duo - Documentation</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="Documentation of the Duo language">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "light" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../preface.html">Preface</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Installation</li><li class="chapter-item expanded "><a href="../installation/duo-lang.html"><strong aria-hidden="true">1.</strong> Installing Duo</a></li><li class="chapter-item expanded "><a href="../installation/editor-support.html"><strong aria-hidden="true">2.</strong> Editor Integration</a></li><li class="chapter-item expanded affix "><li class="part-title">The Duo Language</li><li class="chapter-item expanded "><a href="../language/declarations.html" class="active"><strong aria-hidden="true">3.</strong> Declarations</a></li><li class="chapter-item expanded "><a href="../language/kinds.html"><strong aria-hidden="true">4.</strong> Kinds</a></li><li class="chapter-item expanded "><a href="../language/types.html"><strong aria-hidden="true">5.</strong> Types</a></li><li class="chapter-item expanded "><a href="../language/terms.html"><strong aria-hidden="true">6.</strong> Terms</a></li><li class="chapter-item expanded "><a href="../language/commands.html"><strong aria-hidden="true">7.</strong> Commands</a></li><li class="chapter-item expanded affix "><li class="part-title">Formal Specification</li><li class="chapter-item expanded "><div><strong aria-hidden="true">8.</strong> Specification</div></li><li class="chapter-item expanded affix "><li class="part-title">Language Server Features</li><li class="chapter-item expanded "><a href="../features/features.html"><strong aria-hidden="true">9.</strong> LSP Features</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><a href="../further-reading.html">Further Reading</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Duo - Documentation</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/duo-lang/documentation" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/duo-lang/documentation/edit/main/docs/src/language/declarations.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="toplevel-declarations"><a class="header" href="#toplevel-declarations">Toplevel Declarations</a></h1>
<p>The following declarations are available at the toplevel of a Duo module.</p>
<h2 id="import-statements"><a class="header" href="#import-statements">Import statements</a></h2>
<p>Other Duo modules can be imported using an <code>import</code> declaration.
The following snippet imports the two modules <code>Function</code> and <code>I64</code>, which have to be declared in corresponding files <code>Function.duo</code> and <code>I64.duo</code>.
These files have to be available in the library search path.</p>
<pre><code>import Function;
import I64;
</code></pre>
<p>Circular module imports are not allowed and will generate an error. It is currently not possible to only import some of the declarations of a module, or to import a module qualified.</p>
<h2 id="type-synonyms"><a class="header" href="#type-synonyms">Type synonyms</a></h2>
<p>Type synonyms can be defined using the <code>type</code> keyword.
In the following snippet, a type synonym <code>SBool</code> is defined as an alias for the structural type <code>&lt; True, False &gt;</code>. For the typechecker the two types <code>SBool</code> and <code>&lt; True, False &gt;</code> are indistinguishable.</p>
<pre><code>constructor True;                                                   
constructor False;                                                  
                                                                    
type SBool := &lt; True, False &gt;;  
</code></pre>
<p>Parameterized type synonyms are currently not yet implemented.</p>
<h2 id="type-operators"><a class="header" href="#type-operators">Type operators</a></h2>
<p>Duo supports binary type operators with user-specified associativity and precedence.
For example, the function type and the <code>-&gt;</code> operator are specified in the following manner:</p>
<pre><code>-- | The function type
codata Fun : (-a : CBV, +b : CBV) -&gt; CBN {
    Ap(a,return b)
};

type operator -&gt; rightassoc at 0 := Fun;
</code></pre>
<p>This first defines the codata type <code>Fun</code> and then introduces the arrow symbol as a custom notation for the <code>Fun</code> type with right associativity and precedence level 0.
Every data and codata type has to be introduced with a lexical identifier, <code>Fun</code> in this example, before a type operator can be introduced for the type.
The right-hand side of a type operator declaration expects the name of a typeconstructor with arity 2.
Nullary and unary type operators are currently not implemented.</p>
<h2 id="data-and-codata-declarations"><a class="header" href="#data-and-codata-declarations">Data and codata declarations</a></h2>
<h2 id="constructor-and-destructor-declarations-for-structural-types"><a class="header" href="#constructor-and-destructor-declarations-for-structural-types">Constructor and destructor declarations for structural types</a></h2>
<p>Structural types, i.e. polymorphic variants and structural records, require their respective constructors and destructors to be declared at the toplevel before they can be used.
This is different to, for example, OCaml, where a backtick in front of the name of the constructor is used.
This design was chosen for the following reasons:</p>
<ul>
<li>Docstrings can be attached to the constructors at the declaration site, and these docstrings can be displayed on hover at the respective use sites.</li>
<li>Typos in the names of constructors of polymorphic variants can be detected early.</li>
<li>Since the evaluation of expressions in Duo is kind-directed, we need a place to specify how constructors and destructors of structural types are to be evaluated.</li>
</ul>
<h4 id="constructor-declarations"><a class="header" href="#constructor-declarations">Constructor declarations</a></h4>
<p>In order to define a structural variant of booleans, the following two declarations can be used.</p>
<pre><code>constructor True;
constructor False;
</code></pre>
<p>In this case, no evaluation order has been specified, and in the case of constructors this defaults to <code>CBV</code>.
I.e. the above declaration is a shorthand for the more explicit declaration:</p>
<pre><code>constructor True : CBV;
constructor False : CBV;
</code></pre>
<p>For constructors which take arguments the user has to specify the evaluation order used for the respective argument position.
Structural peano natural numbers where the argument to the successor constructor is evaluated eagerly are declared as follows:</p>
<pre><code>constructor Z;
constructor S(CBV);
</code></pre>
<p>which, again, is shorthand for</p>
<pre><code>constructor Z : CBV;
constructor S(CBV) : CBV;
</code></pre>
<p>These constructors then occur in <a href="types.html#structural-data-types">structural data types</a> like <code>&lt; True, False&gt; </code> or <code>&lt; S(&lt; Z &gt;)&gt;</code>.</p>
<h4 id="destructor-declarations"><a class="header" href="#destructor-declarations">Destructor declarations</a></h4>
<p>Destructor declarations are similar to constructor declarations, with one difference.
If you don't specify a evaluation order for the destructor, it defaults to CBN evaluation.
Hence, the declaration</p>
<pre><code>destructor Name(CBV);
</code></pre>
<p>is shorthand for the declaration</p>
<pre><code>destructor Name(CBV) : CBN;
</code></pre>
<p>These destructors then occur in <a href="types.html#structural-codata-types">structural codata types</a> like <code>{ Name(String) }</code>.</p>
<h2 id="producer-declarations"><a class="header" href="#producer-declarations">Producer declarations</a></h2>
<p>A producer is declared using the <code>def prd</code> syntax.
An optional type signature can be specified.</p>
<pre><code>def prd two := S(S(Z));

def prd three: Nat := S(S(S(Z)));

def prd id: forall a. a -&gt; a := \x =&gt; x;
</code></pre>
<p>By default, producers defined using the <code>def prd</code> keywords are not recursive.
For recursive definitions, the keyword <code>rec</code> has to be added.</p>
<h2 id="consumer-declarations"><a class="header" href="#consumer-declarations">Consumer declarations</a></h2>
<p>A consumer is declared using the <code>def cns</code> syntax.
An optional type signature can be specified.</p>
<pre><code>def cns exitOnBool := case {
    True =&gt; #ExitSuccess,
    False =&gt; #ExitFailure
};

def cns exitOnBool : Bool := case {
    True =&gt; #ExitSuccess,
    False =&gt; #ExitFailure
};
</code></pre>
<p>By default, consumers defined using the <code>def cns</code> keywords are not recursive.
For recursive definitions, the keyword <code>rec</code> has to be added.</p>
<h2 id="command-declarations"><a class="header" href="#command-declarations">Command declarations</a></h2>
<p>A command is declared using the <code>def cmd</code> syntax.
Commands have no type, and it is therefore not possible to write a type signature.</p>
<pre><code>def cmd exit := #ExitFailure;

def cmd main := #ExitSuccess;
</code></pre>
<p>The command called &quot;main&quot; is treated specially, since execution starts with the execution of the &quot;main&quot; command.</p>
<h2 id="type-class-declarations"><a class="header" href="#type-class-declarations">Type Class declarations</a></h2>
<p>A type class is declared using the <code>class</code> keyword.
Currently only single parameter type classes are supported, thus a single type variable together with its kind and variance have to be declared.</p>
<pre><code>class Show(+a : CBV){
    Show(a, return String)
};
</code></pre>
<p>Inside the body of the class declaration an arbitrary number of type class methods can be defined.
The signature has to respect the variance of the type variable above.
Method and type class name live in different name spaces, so it is possible to overload them.</p>
<h2 id="instance-declarations"><a class="header" href="#instance-declarations">Instance declarations</a></h2>
<p>An instance of a type class is declared using the <code>instance</code> keyword.
Unlike in languages such as Haskell, instances have to be named.</p>
<pre><code>instance showBool : Show Bool {
    Show(b, k) =&gt; case b of {
        True =&gt; MkString(&quot;True&quot;),
        False =&gt; MkString(&quot;False&quot;)
    } &gt;&gt; k
};
</code></pre>
<p>Type class methods are implemented as commands and can be used as such, e.g.:</p>
<pre><code>def cmd main := Show(True, mu x. #Print(x, #ExitSuccess));
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../installation/editor-support.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="../language/kinds.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../installation/editor-support.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="../language/kinds.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
